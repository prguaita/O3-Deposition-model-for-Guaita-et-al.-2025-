; ============================
; Main folders and general settings
; ============================

folder_main      = 			; Main directory containing all subfolders with data and results
folder_data      = cmip6 data       	; Subfolder containing climate model input data (CMIP6 dataset)
folder_result    = pod_output       	; Subfolder where model output/results will be saved

model_name      = UKESM1-0-LL       ; Name of the climate model to use (e.g., UKESM1-0-LL)
file_suffix     =                   ; Optional suffix added to filenames during load/save 
                                    ; Leave empty for global runs; used for single-point simulations

experiment      = 'historical'      ; Experiment type: 'historical' (past climate) or 'ssp' (future scenarios)

plant_species   = wheat             ; Plant species under study (used for phenology, LAI, etc.)

filter_hem     = N                  ; Hemisphere filter: 'N' = Northern Hemisphere, 'S' = Southern Hemisphere, 'p' = point simulation

table_out_option = false            ; Output a summary table with multiple variables? (true/false)
                                  ; WARNING: Works only for pointwise simulations, not for global runs

yr_start       = 2000               ; Start year of the simulation period
yr_end         = 2014               ; End year of the simulation period

timestep       = 1                  ; Time step in hours for model calculations and output
                                  ; Output times represent the midpoint of the interval, e.g., if timestep=3,
                                  ; outputs are at 1.5h, 4.5h, 7.5h, etc.

; ============================
; Input Model Parameters
; ============================

[input_model]

; Calendar type defines how model years are counted:
;   'fix'  = all years have a fixed number of days (e.g., 360)
;            You must specify n_day_year when using 'fix'.
;   'leap' = model includes leap years with variable year length (no need to specify n_day_year).

opt_calendar = fix                 ; Calendar type used by the climate model

n_day_year = 360                  ; Number of days per year if 'fix' calendar is selected (e.g., 360-day calendar)

; Input data selection switches:
; If set to false, the variable will be modelled rather than loaded.

LE    = false                     ; Latent heat flux input (false = modelled)
Rn    = true                      ; Net radiation input (true = read from data)
H     = true                      ; Sensible heat flux input (true = read from data)

; ============================
; Plant Thermal Time Parameters - Winter Wheat
; ============================

[plant_TT]

; Thermal time (degree-days above TT_min) defining phenological stages for wheat.
; Thermal time accumulation starts at sowing date.

TT_min       = 0                 ; [°C] Base temperature below which thermal time is not accumulated

; Phenological stage thermal time thresholds (°C day):

TT_one       = 370               ; Emergence phase start
TT_two       = 530               ; Tillering phase start
TT_three     = 900               ; Jointing phase start

TT_A_start   = 1425              ; Start of leaf area accumulation period
TT_A_two     = 1725              ; Leaf area index (LAI) begins to decrease
TT_A_three   = 2150              ; Change in LAI decrease slope
TT_A_end     = 2325              ; End of accumulation / maturity

; References: Gonzales et al. and Zhang (2018)

; ============================
; Plant Thermal Time Parameters - Spring Wheat
; ============================

[plant_TT_spring]

TT_min       = 0                 ; Base temperature for thermal time accumulation [°C]

; Phenological stages for spring wheat:
; Emergence is set at 70°C day, mid-anthesis around 1075°C day from sowing.

TT_one       = 70                ; Emergence
TT_two       = 230               ; Tillering (emergence + 160°C day)
TT_three     = 600               ; Jointing (emergence + 530°C day)

TT_A_start   = 875               ; Start of leaf area accumulation
TT_A_two     = 1175              ; LAI begins to decrease
TT_A_three   = 1600              ; LAI decrease slope changes
TT_A_end     = 1775              ; End of accumulation / maturity

; Based on Gonzales and Zhang (2018), Mapping manual

; ============================
; Plant Thermal Time Parameters - Mediterranean Wheat
; ============================

[plant_TT_mediterranean]

TT_min       = 0                 ; Base temperature for thermal time accumulation [°C]

; Thermal time thresholds for wheat grown in Mediterranean conditions.
; Mid-anthesis occurs about 1800°C day after sowing (1256°C day from 1 Jan + 550°C day offset).

TT_one       = 370               ; Emergence
TT_two       = 530               ; Tillering
TT_three     = 900               ; Jointing

TT_A_start   = 1500              ; Start of leaf area accumulation
TT_A_two     = 1900              ; LAI begins to decrease
TT_A_three   = 2330              ; LAI decrease slope changes
TT_A_end     = 2400              ; End of accumulation / maturity

; Reference: Gonzales and Zhang (2018), ENPO paper calculations

; ============================
; Leaf Area Index (LAI) Values
; ============================

[LAI]

; LAI values associated with each phenological phase for wheat

one       = 0.1                 ; LAI at emergence
two       = 0.3                 ; LAI at tillering
three     = 4.5                 ; LAI at jointing
A_start   = 6                   ; LAI at start of accumulation period
A_two     = 6                   ; LAI at beginning of decrease
A_three   = 4.2                 ; LAI during slope change of decrease
A_end     = 0                   ; LAI at end of accumulation/maturity

; ============================
; Stem Area Index (SAI) Values
; ============================

[SAI]

; SAI values corresponding to phenological phases for wheat

one       = 0.14                ; SAI at emergence
two       = 0.43                ; SAI at tillering
three     = 6.39                ; SAI at jointing
A_start   = 8.52                ; SAI at start of accumulation
A_two     = 8.52                ; SAI at beginning of decrease
A_three   = 7.01                ; SAI during slope change of decrease
A_end     = 6.39                ; SAI at end of accumulation/maturity

[plant]
; ====================
; Plant Parameters
; ====================

; Method used to calculate plant parameters:
; 'TT'        = based on Thermal Time (phenology modeled with thermal time accumulation)
; 'prescribed' = prescribed values are used, requiring an input folder with plant data files (LAI, SAI, root depth, albedo, etc.)
type        = TT

; Folder path containing plant parameter data files (LAI, SAI, Root Depth, Albedo)
folder_plant=

; Maximum root depth of the plant [meters]
RD_max      = 1     

; Maximum canopy height [meters] for generic parametrization
h_c_max     = 1     

; Maximum canopy height for Mediterranean parametrization (typically lower due to climate)
h_c_max_med = 0.75  

; Constant canopy albedo value (dimensionless, fraction of reflected solar radiation)
Alb         = 0.2   

; Displacement height expressed as a fraction of canopy height 
; (distance above ground where wind speed theoretically becomes zero)
d_frac      = 0.65

; Momentum roughness length expressed as a fraction of canopy height
z0M_frac    = 0.13

; Scalar roughness length expressed as a fraction of momentum roughness length
z0H_frac    = 0.2

; Crosswind leaf dimension [meters], used in turbulence and deposition calculations
cw_Leaf_dim = 0.02

; Stomatal distribution type:
; n = 1 indicates amphistomatuous leaves (stomata on both leaf sides)
; n = 2 indicates hypostomatuous leaves (stomata only on one side)
n           = 2

; PODY threshold [nmol m-2 s-1], photochemical ozone damage threshold below which damage is negligible
Y           = 6

[dep]
; ====================
; Deposition Model Options
; ====================

; Conductance type used for deposition calculations:
; 'MM' = Mapping Manual parameterization (standard)
; 'c'  = Custom parameterization
conductance_type = MM

; Soil water availability options:
; 'full'       = Soil always at field capacity (no water stress)
; 'prescribed' = Soil moisture prescribed from input data files
; 'model'      = Soil moisture modeled dynamically; requires static maps for Field Capacity (FC) and Wilting Point (WP)
; 'model_mod'  = Modeled with FC and WP specified directly in this file (see FC_config and WP_config)
soil_option    = model

; Field capacity (fraction of soil water content at field capacity)
FC_config     = 0.35

; Wilting point (fraction of soil water content at wilting point)
WP_config     = 0.15

; Temperature option used for stomatal conductance:
; 'best'   = Assumes optimal temperature (T_opt) always
; 'real'   = Uses actual temperature from data
; 'topt'   = Uses optimal temperature only within Jarvis algorithm (stomatal model)
temp_option   = real

; Ozone concentration scaling options at canopy height:
; 'prescribed'          = Use ozone data provided as input
; 'same_tgt_ref'        = Target surface and reference surface ozone concentrations are the same
; 'different_tgt_ref'   = Target and reference concentrations differ (e.g. provided at lower height than canopy)
ozone_scaling_option = same_tgt_ref

; Neutral atmosphere assumption:
; true  = Atmosphere is always neutral (simplifies turbulence calculations)
; false = Atmosphere stability (stable, neutral, unstable) is modeled dynamically
neutral_atm_option = false

; Should evapotranspiration (ET) be calculated only during leaf accumulation period?
ET_ACC_option = false

; Account for CO2 concentration effect on stomatal conductance?
; true  = CO2 effect included
; false = CO2 effect not included
CO2_effect = false


[const]
; ====================
; Model Constants
; ====================

; Height of wind measurement stations [meters]
z_m_wnd   = 10

; Height of temperature, humidity, and other meteorological measurements [meters]
z_m_T     = 2

; von Karman constant (dimensionless)
kar       = 0.41

; Prandtl number for air (dimensionless)
Pr        = 0.70673

; Acceleration due to gravity [m s^-2]
g_0       = 9.8067

; Molar mass of dry air [g mol^-1]
M_dry     = 29

; Molar mass of water vapor [g mol^-1]
M_w       = 18

; Molar mass of ozone [g mol^-1]
M_O3      = 48

; Universal gas constant [J mol^-1 K^-1]
Re        = 8.314472

; Kinematic viscosity of air at 15°C [m^2 s^-1]
nu        = 1.47e-5

; Specific heat capacity of dry air at constant pressure [J kg^-1 K^-1]
c_p_std   = 1004.8

; Psychrometric constant [Pa kg^-1]
gamma     = 67

; Temperature at 0°C in Kelvin
T_0       = 273.15

; Conversion from global radiation (W m^-2) to Photosynthetically Active Radiation (PAR) (W m^-2)
Qsw2PAR   = 0.45

; Conversion factor from PAR (W m^-2) to Photosynthetic Photon Flux Density (PPFD) [umol m^-2 s^-1]
Wm2_PPFD  = 4.57

; Light extinction coefficient through canopy (dimensionless)
; Based on Zhang (2014) meta-analysis of terrestrial ecosystems
Ka        = 0.65

; Molecular diffusivity at 0°C and 1 atm for:
; Ozone [cm^2 s^-1]
D01_O3    = 0.1444

; Water vapor [cm^2 s^-1]
D01_W     = 0.2178

; Heat [cm^2 s^-1]
D01_Heat  = 0.18055

; Diffusivity correction factors found through fitting from Massman (1998)
alpha_diffusivity_O3   = 1.81
alpha_diffusivity_W    = 1.81
alpha_diffusivity_Heat = 1.54

; Latent heat flux parameter (depends on environment)
; For irrigated fields ranges typically 0.8 - 1.2
alpha     = 0.8

; Constant term used in latent heat calculation [W m^-2]
beta      = 0.2

; Cuticular resistance to ozone deposition [s m^-1] for SAI=1 (stem area index)
r_cut_O3  = 2500

; Soil resistance to deposition [s m^-1]
R_soil    = 200


[g_par_MM]
; ==============================
; Stomatal Conductance Parameters (Mapping Manual)
; ==============================

; Soil moisture variable used in Jarvis algorithm:
; PAW = Plant Available Water (preferred)
; SWC = Soil Water Content (alternative)
soil_option = PAW

; Time base for stomatal conductance modeling:
; TT  = Thermal Time (accumulated degree days)
; doy = Day of Year (specified DOYs)
time_option = TT

; Maximum stomatal conductance for water vapor [mmol m^-2 s^-1]
g_max_W     = 754.1

; Parameter controlling the rapidity of the light response curve (steepness)
light_a     = 0.0105

; Optimal temperature [°C] at which stomatal conductance is not limited
T_opt       = 26

; Minimum temperature [°C] below which stomatal conductance is limited to minimum (f_min)
T_min       = 12

; Maximum temperature [°C] above which stomatal conductance is limited to minimum (f_min)
T_max       = 40

; Vapor Pressure Deficit (VPD) thresholds [kPa]:
; VPD_max = VPD below which stomatal conductance is not limited
VPD_max    = 1.2

; VPD_min = VPD above which stomata close (stomatal conductance reaches minimum fraction f_min)
VPD_min    = 3.2

; Critical daily cumulative VPD [kPa] for stomatal closure using Uddling model
sum_VPD_crit = 8

; Placeholder parameters (to be defined or calculated dynamically)
g           =  
h           =  

; Threshold for Plant Available Water [%] above which water stress is not limiting
PAW_t       = 50

; Parameters for ozone effect function fO3
a_O3        = 14     ; denominator parameter
b_O3        = 8      ; exponent parameter

; Parameters related to CO2 effect on stomatal conductance
fmin_CO2    = 0.2823 ; minimum fractional conductance under CO2 effect
a_CO2       = 0.5480 ; CO2 response parameter
CO2_ref     = 384.2  ; reference CO2 concentration [ppm]

; Phenology-related parameters describing stomatal conductance reduction during flag leaf senescence:
p_a         = 0.3    ; difference between maximum fraction of g_max and f_phen at onset of senescence
p_e         = 0.7    ; fraction during senescence
p_one       = 1625   ; thermal time [°C days] from sowing when f_phen becomes maximal
p_two       = 1725   ; thermal time when f_phen stops being maximal
p_three     = 2150   ; thermal time when f_phen equals p_e

; Minimum fractional stomatal conductance (f_min)
f_min       = 0.01

; Uddling model parameter controlling stomatal conductance update rate [0-1]
; k_uddling=1 means full update (gsto_n = gsto_n+1)
; Uddling (2004) suggested ~0.92 for Betula pendula
k_uddling   = 1

; Model options (boolean):
; f_ozone_option  = true enables premature senescence function due to ozone damage
; uddling_option  = true enables Uddling's VPD cumulative model for stomatal closure
f_ozone_option = true
uddling_option = true



[g_par_MM_spring]
; ==============================
; Spring-specific Stomatal Conductance Parameters (Mapping Manual)
; ==============================

; These parameters are identical to [g_par_MM] except for phenology timings adjusted for spring growth.

soil_option = PAW
time_option = TT

g_max_W     = 754.1
light_a     = 0.0105
T_opt       = 26
T_min       = 12
T_max       = 40
VPD_max     = 1.2
VPD_min     = 3.2
sum_VPD_crit= 8
g           =  
h           =  
PAW_t       = 50
a_O3        = 14
b_O3        = 8
fmin_CO2    = 0.2823
a_CO2       = 0.5480
CO2_ref     = 384.2

; Phenology parameters (thermal time in °C days from sowing):
p_a         = 0.3
p_e         = 0.7
p_one       = 1075    ; earlier start for maximum f_phen (spring)
p_two       = 1175    ; earlier end for maximum f_phen (spring)
p_three     = 1600    ; f_phen at p_e (spring)

f_min       = 0.01
k_uddling   = 1

f_ozone_option = true
uddling_option = true

;--------------------------------

[g_par_MM_mediterranean]
; ==============================
; Stomatal conductance parameters for Mediterranean conditions
; ==============================

; Soil moisture variable used in Jarvis algorithm:
; PAW = Plant Available Water
; SWC = Soil Water Content (used here)
soil_option = SWC

; Time base for stomatal conductance:
; TT  = Thermal Time (accumulated °C days)
; doy = Day of Year (specified days)
time_option = TT

; Maximum stomatal conductance for water vapor [mmol m^-2 s^-1]
g_max_W     = 648.6

; Parameter controlling light response curve steepness
light_a     = 0.0105

; Temperature parameters [°C]:
T_opt       = 28    ; Optimal temperature where stomatal conductance is not limited
T_min       = 12    ; Below this temperature conductance limited to minimum
T_max       = 39    ; Above this temperature conductance limited to minimum

; Vapor Pressure Deficit (VPD) thresholds [kPa]:
VPD_max     = 3.2   ; VPD below which stomatal conductance not limited
VPD_min     = 4.6   ; VPD above which stomata close (reach minimum conductance)

; Critical daily cumulative VPD for stomatal closure (Uddling model) [kPa]
sum_VPD_crit = 16

; Placeholder parameters
g           =  
h           =  

; Soil Water Content thresholds [%]:
SWC_max     = 18.6  ; Soil moisture above which no limitation
SWC_min     = 4.7   ; Soil moisture below which stomata close or are severely limited

; Parameters for ozone effect function fO3:
a_O3        = 14    ; denominator parameter
b_O3        = 8     ; exponent parameter

; CO2 effect parameters:
fmin_CO2    = 0.2823
a_CO2       = 0.5480
CO2_ref     = 384.2

; Phenology parameters (thermal time in °C days from sowing):
p_a         = 0.3   ; difference in fraction of g_max at onset of flag leaf senescence
p_e         = 0.7   ; fraction during senescence
p_one       = 1800  ; °C days when f_phen starts maximum
p_two       = 1900  ; °C days when f_phen stops maximum
p_three     = 2330  ; °C days when f_phen = p_e

; Minimum fractional stomatal conductance:
f_min       = 0.01

; Uddling model parameter for stomatal conductance update [0-1]
; 1 = full update (gsto_n = gsto_n+1)
; Uddling (2004) suggests 0.92 for Betula pendula
k_uddling   = 1

; Model options:
f_ozone_option = true   ; enable ozone-induced premature senescence function
uddling_option = true   ; enable Uddling VPD cumulative stomatal closure model


;------------------------------------------

[g_par_c]
; ==============================
; Stomatal conductance custom parametrization
; ==============================

; Soil moisture variable used in Jarvis algorithm:
soil_option = PAW

; Time base for stomatal conductance:
time_option = doy    ; based on specified day of year

g_max_W     = 754       ; max stomatal conductance for water vapor
light_a     = 0.0105    ; light response curve steepness

; Temperature parameters [°C]:
T_opt       = 26
T_min       = 12
T_max       = 40

; VPD thresholds [kPa]:
VPD_max     = 1.2
VPD_min     = 3.2

; Critical daily cumulative VPD for stomatal closure:
sum_VPD_crit = 8

; Placeholder parameters:
g           =
h           =

; PAW threshold [%] above which no water limitation:
PAW_t       = 50

; Ozone effect parameters:
a_O3        = 14
b_O3        = 8

; Phenology parameters (thermal time in °C days):
p_a         = 0.3
p_e         = 0.7
p_one       = 1625
p_two       = 1725
p_three     = 2150   ; phenology f_phen value at p_three (from Jan 1)

; Minimum fractional stomatal conductance:
f_min       = 0.01

; Uddling model parameter:
k_uddling   = 0.92   ; recommended value from Uddling (2004)

; Model options:
f_ozone_option = true
uddling_option = true
